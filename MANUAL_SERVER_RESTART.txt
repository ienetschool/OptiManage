MANUAL SERVER RESTART COMMANDS
=============================

Since the APIs are working but you're getting 502 on the main site, 
the issue is likely with static file serving or the frontend build.

In your SSH terminal, run these commands:

1. cd /var/www/vhosts/vivaindia.com/opt

2. ps aux | grep tsx

3. pkill -f tsx

4. # Build the frontend first
   cd client
   npm run build
   cd ..

5. # Copy built files to server public directory
   mkdir -p server/public
   cp -r client/dist/* server/public/

6. # Start server with proper static file serving
   NODE_ENV=production PORT=8080 FORCE_PRODUCTION=true DATABASE_URL='mysql://ledbpt_optie:g79h94LAP@localhost:3306/opticpro' nohup npx tsx server/index.ts > production.log 2>&1 &

7. # Test both API and static files
   curl -s http://localhost:8080/api/dashboard | head -c 100
   curl -s http://localhost:8080/ | head -c 200

8. # Check logs for any errors
   tail -20 production.log

The key is making sure the frontend is built and copied to server/public/